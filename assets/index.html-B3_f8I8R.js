import{_ as p,c as t,a,b as h,d as n,w as l,r as d,o as c,e}from"./app-BVpc6fz1.js";const r={},k={class:"table-of-contents"};function o(u,s){const i=d("router-link");return c(),t("div",null,[s[22]||(s[22]=a("figure",null,[a("img",{src:"https://oss.moniter.top/blog/2025-02-19/backend.jpg",alt:"backend",tabindex:"0",loading:"lazy"}),a("figcaption",null,"backend")],-1)),a("nav",k,[a("ul",null,[a("li",null,[n(i,{to:"#一、前言"},{default:l(()=>s[0]||(s[0]=[e("一、前言")])),_:1})]),a("li",null,[n(i,{to:"#二、环境准备"},{default:l(()=>s[1]||(s[1]=[e("二、环境准备")])),_:1}),a("ul",null,[a("li",null,[n(i,{to:"#_1-系统更新"},{default:l(()=>s[2]||(s[2]=[e("1. 系统更新")])),_:1})]),a("li",null,[n(i,{to:"#_2-安装编译依赖-关键步骤"},{default:l(()=>s[3]||(s[3]=[e("2. 安装编译依赖（关键步骤）")])),_:1})])])]),a("li",null,[n(i,{to:"#三、安装流程"},{default:l(()=>s[4]||(s[4]=[e("三、安装流程")])),_:1}),a("ul",null,[a("li",null,[n(i,{to:"#_1-源码获取与解压"},{default:l(()=>s[5]||(s[5]=[e("1. 源码获取与解压")])),_:1})]),a("li",null,[n(i,{to:"#_2-编译配置-核心步骤"},{default:l(()=>s[6]||(s[6]=[e("2. 编译配置（核心步骤）")])),_:1})]),a("li",null,[n(i,{to:"#_3-编译与安装"},{default:l(()=>s[7]||(s[7]=[e("3. 编译与安装")])),_:1})])])]),a("li",null,[n(i,{to:"#四、环境配置"},{default:l(()=>s[8]||(s[8]=[e("四、环境配置")])),_:1}),a("ul",null,[a("li",null,[n(i,{to:"#_1-配置全局路径"},{default:l(()=>s[9]||(s[9]=[e("1. 配置全局路径")])),_:1})]),a("li",null,[n(i,{to:"#_2-验证安装"},{default:l(()=>s[10]||(s[10]=[e("2. 验证安装")])),_:1})])])]),a("li",null,[n(i,{to:"#五、高级配置"},{default:l(()=>s[11]||(s[11]=[e("五、高级配置")])),_:1}),a("ul",null,[a("li",null,[n(i,{to:"#_1-创建版本快捷方式"},{default:l(()=>s[12]||(s[12]=[e("1. 创建版本快捷方式")])),_:1})]),a("li",null,[n(i,{to:"#_2-虚拟环境支持"},{default:l(()=>s[13]||(s[13]=[e("2. 虚拟环境支持")])),_:1})])])]),a("li",null,[n(i,{to:"#六、维护指南"},{default:l(()=>s[14]||(s[14]=[e("六、维护指南")])),_:1}),a("ul",null,[a("li",null,[n(i,{to:"#_1-版本切换示例"},{default:l(()=>s[15]||(s[15]=[e("1. 版本切换示例")])),_:1})]),a("li",null,[n(i,{to:"#_2-安全卸载"},{default:l(()=>s[16]||(s[16]=[e("2. 安全卸载")])),_:1})])])]),a("li",null,[n(i,{to:"#七、故障排查"},{default:l(()=>s[17]||(s[17]=[e("七、故障排查")])),_:1}),a("ul",null,[a("li",null,[n(i,{to:"#常见问题解决方案"},{default:l(()=>s[18]||(s[18]=[e("常见问题解决方案")])),_:1})])])]),a("li",null,[n(i,{to:"#八、性能优化建议"},{default:l(()=>s[19]||(s[19]=[e("八、性能优化建议")])),_:1})]),a("li",null,[n(i,{to:"#九、版本升级策略"},{default:l(()=>s[20]||(s[20]=[e("九、版本升级策略")])),_:1})]),a("li",null,[n(i,{to:"#十、结语"},{default:l(()=>s[21]||(s[21]=[e("十、结语")])),_:1})])])]),s[23]||(s[23]=h(`<h2 id="一、前言" tabindex="-1"><a class="header-anchor" href="#一、前言"><span>一、前言</span></a></h2><p>本文面向需要在 Linux 服务器（以 Ubuntu 为例）上<strong>并行安装多版本 Python</strong> 的开发者和运维人员。通过源码编译的方式，我们将安全地在腾讯云 CVM 上部署 Python 3.12.8，同时完整保留系统原有 Python 环境。本方案具有以下特点：</p><ul><li>✅ 100% 兼容性测试（Ubuntu 20.04/22.04 LTS）</li><li>⚡ 编译优化加速指南</li><li>🔒 OpenSSL 1.1.1+ 安全支持</li><li>📦 独立环境隔离部署</li></ul><hr><h2 id="二、环境准备" tabindex="-1"><a class="header-anchor" href="#二、环境准备"><span>二、环境准备</span></a></h2><h3 id="_1-系统更新" tabindex="-1"><a class="header-anchor" href="#_1-系统更新"><span>1. 系统更新</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">apt</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">update</span><span class="space"> </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">&amp;&amp;</span><span class="space"> </span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">apt</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">upgrade</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-y</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_2-安装编译依赖-关键步骤" tabindex="-1"><a class="header-anchor" href="#_2-安装编译依赖-关键步骤"><span>2. 安装编译依赖（关键步骤）</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">apt</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">install</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-y</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">build-essential</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">zlib1g-dev</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">libncurses5-dev</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">libgdbm-dev</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">libnss3-dev</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">libssl-dev</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">libreadline-dev</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">libffi-dev</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">libsqlite3-dev</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">wget</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">libbz2-dev</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">curl</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">llvm</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>依赖说明</strong>：</p><ul><li><code>libssl-dev</code>：支持 HTTPS 请求</li><li><code>libsqlite3-dev</code>：启用 SQLite 数据库模块</li><li><code>libffi-dev</code>：保证 pip 等工具的正常运作</li></ul><hr><h2 id="三、安装流程" tabindex="-1"><a class="header-anchor" href="#三、安装流程"><span>三、安装流程</span></a></h2><h3 id="_1-源码获取与解压" tabindex="-1"><a class="header-anchor" href="#_1-源码获取与解压"><span>1. 源码获取与解压</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">cd</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/tmp</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">wget</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">https://www.python.org/ftp/python/3.12.8/Python-3.12.8.tgz</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">tar</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-xzf</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Python-3.12.8.tgz</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">cd</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Python-3.12.8</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-编译配置-核心步骤" tabindex="-1"><a class="header-anchor" href="#_2-编译配置-核心步骤"><span>2. 编译配置（核心步骤）</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">./configure</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">--prefix=/usr/local/python3.12</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">--enable-optimizations</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">--with-openssl=/usr</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">--enable-loadable-sqlite-extensions</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">--with-system-ffi</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">--with-ensurepip=install</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>参数解析</strong>：</p><table><thead><tr><th>参数</th><th>作用</th></tr></thead><tbody><tr><td><code>--prefix</code></td><td>指定独立安装路径，防止系统污染</td></tr><tr><td><code>--enable-optimizations</code></td><td>启用 PGO 优化（提升 10-20% 性能）</td></tr><tr><td><code>--with-ensurepip</code></td><td>自动安装 pip 包管理器</td></tr></tbody></table><h3 id="_3-编译与安装" tabindex="-1"><a class="header-anchor" href="#_3-编译与安装"><span>3. 编译与安装</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">make</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-j</span><span class="space"> </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">$(</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">nproc</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">)</span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">使用全部</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">CPU</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">核心加速编译</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">make</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">install</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>编译时间参考</strong>：</p><ul><li>1核 CPU：约 15-20 分钟</li><li>4核 CPU：约 5-8 分钟</li></ul><hr><h2 id="四、环境配置" tabindex="-1"><a class="header-anchor" href="#四、环境配置"><span>四、环境配置</span></a></h2><h3 id="_1-配置全局路径" tabindex="-1"><a class="header-anchor" href="#_1-配置全局路径"><span>1. 配置全局路径</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">echo</span><span class="space"> </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">export</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">PATH=&quot;/usr/local/python3.12/bin:$PATH&quot;</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span class="space"> </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">|</span><span class="space"> </span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">tee</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-a</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/etc/profile.d/python312.sh</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">source</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/etc/profile.d/python312.sh</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>技术细节</strong>：<br> 使用 <code>tee</code> 命令的优势：</p><ul><li>同时完成<strong>终端输出</strong>和<strong>文件写入</strong></li><li>完美配合 <code>sudo</code> 处理权限问题</li><li><code>-a</code> 参数保证<strong>追加写入</strong>不覆盖原有配置</li></ul><h3 id="_2-验证安装" tabindex="-1"><a class="header-anchor" href="#_2-验证安装"><span>2. 验证安装</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">版本检查</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">python3.12</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">--version</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">预期输出:</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">Python</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">3.12.8</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">路径确认</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">which</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">python3.12</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">预期路径:</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">/usr/local/python3.12/bin/python3.12</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">pip</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">验证</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">pip3.12</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">--version</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">应显示对应</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">pip</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">版本</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="五、高级配置" tabindex="-1"><a class="header-anchor" href="#五、高级配置"><span>五、高级配置</span></a></h2><h3 id="_1-创建版本快捷方式" tabindex="-1"><a class="header-anchor" href="#_1-创建版本快捷方式"><span>1. 创建版本快捷方式</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">update-alternatives</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">--install</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/usr/local/bin/python3.12</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">python3.12</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/usr/local/python3.12/bin/python3.12</span><span class="space"> </span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">1</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_2-虚拟环境支持" tabindex="-1"><a class="header-anchor" href="#_2-虚拟环境支持"><span>2. 虚拟环境支持</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">创建虚拟环境</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">python3.12</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-m</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">venv</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/path/to/venv</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">激活环境</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">source</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/path/to/venv/bin/activate</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="六、维护指南" tabindex="-1"><a class="header-anchor" href="#六、维护指南"><span>六、维护指南</span></a></h2><h3 id="_1-版本切换示例" tabindex="-1"><a class="header-anchor" href="#_1-版本切换示例"><span>1. 版本切换示例</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">查看所有</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">Python</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">版本</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ls</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/usr/bin/python</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">*</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/usr/local/bin/python</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">*</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">临时调用特定版本</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">/usr/local/python3.12/bin/python3.12</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-V</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-安全卸载" tabindex="-1"><a class="header-anchor" href="#_2-安全卸载"><span>2. 安全卸载</span></a></h3><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">rm</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-rf</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/usr/local/python3.12</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">rm</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/etc/profile.d/python312.sh</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">重新加载环境</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">source</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/etc/profile</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="七、故障排查" tabindex="-1"><a class="header-anchor" href="#七、故障排查"><span>七、故障排查</span></a></h2><h3 id="常见问题解决方案" tabindex="-1"><a class="header-anchor" href="#常见问题解决方案"><span>常见问题解决方案</span></a></h3><table><thead><tr><th>问题现象</th><th>解决方案</th></tr></thead><tbody><tr><td><code>ModuleNotFoundError: No module named &#39;_ssl&#39;</code></td><td>重新安装 <code>libssl-dev</code> 后编译</td></tr><tr><td>pip 安装速度慢</td><td>配置阿里云镜像：<code>pip3.12 config set global.index-url https://mirrors.aliyun.com/pypi/simple/</code></td></tr><tr><td>环境变量未生效</td><td>执行 <code>source /etc/profile</code> 或重新登录</td></tr><tr><td>编译时内存不足</td><td>添加 1GB swap 空间：<code>sudo fallocate -l 1G /swapfile &amp;&amp; sudo mkswap /swapfile &amp;&amp; sudo swapon /swapfile</code></td></tr></tbody></table><hr><h2 id="八、性能优化建议" tabindex="-1"><a class="header-anchor" href="#八、性能优化建议"><span>八、性能优化建议</span></a></h2><ol><li><p><strong>PGO 优化</strong>：<br> 在 <code>./configure</code> 时添加 <code>--enable-optimizations</code> 参数，通过 Profile Guided Optimization 提升解释器性能。</p></li><li><p><strong>内存分配器优化</strong>：<br> 使用 jemalloc 替代默认分配器：</p><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">apt</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">install</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">libjemalloc-dev</span></span>
<span class="line"><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">export</span><span class="space"> </span><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">JE_MALLOC_CONF</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">background_thread:true,metadata_thp:auto</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>LTO 链接优化</strong>：<br> 在编译时添加 <code>CFLAGS=&quot;-flto&quot; LDFLAGS=&quot;-flto&quot;</code> 环境变量，实现链接时优化。</p></li></ol><hr><h2 id="九、版本升级策略" tabindex="-1"><a class="header-anchor" href="#九、版本升级策略"><span>九、版本升级策略</span></a></h2><p>当需要升级到新版 Python 时：</p><ol><li>保留旧版本目录</li><li>重复本文流程指定新路径（如 <code>/usr/local/python3.12.9</code>）</li><li>通过 <code>update-alternatives</code> 管理多版本</li></ol><div class="language-shell line-numbers-mode" data-ext="shell" data-title="shell"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">update-alternatives</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">--install</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/usr/local/bin/python3</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">python3</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/usr/local/python3.12.8/bin/python3.12</span><span class="space"> </span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">100</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">update-alternatives</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">--install</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/usr/local/bin/python3</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">python3</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/usr/local/python3.12.9/bin/python3.12</span><span class="space"> </span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">200</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="十、结语" tabindex="-1"><a class="header-anchor" href="#十、结语"><span>十、结语</span></a></h2><p>源码编译方式，实现了：<br> 🚀 与系统环境的完美隔离<br> 🔧 细粒度的编译选项控制<br> 📈 获得最佳运行时性能</p><p>建议配合 monitoring 工具（如 py-spy）持续观察 Python 运行时表现。对于生产环境，推荐使用 Docker 容器化部署方案。</p>`,59))])}const g=p(r,[["render",o],["__file","index.html.vue"]]),A=JSON.parse('{"path":"/linux/h3zzfe0o/","title":"在腾讯云 CVM 上安全安装 Python 3.12.8 的完整指南","lang":"zh-CN","frontmatter":{"createTime":"2025/02/19 11:42:22","permalink":"/linux/h3zzfe0o/","title":"在腾讯云 CVM 上安全安装 Python 3.12.8 的完整指南","description":"backendbackend 一、前言 本文面向需要在 Linux 服务器（以 Ubuntu 为例）上并行安装多版本 Python 的开发者和运维人员。通过源码编译的方式，我们将安全地在腾讯云 CVM 上部署 Python 3.12.8，同时完整保留系统原有 Python 环境。本方案具有以下特点： ✅ 100% 兼容性测试（Ubuntu 20.04/...","head":[["meta",{"property":"og:url","content":"https://notes.moniter.top/linux/h3zzfe0o/"}],["meta",{"property":"og:site_name","content":"Richie Lin"}],["meta",{"property":"og:title","content":"在腾讯云 CVM 上安全安装 Python 3.12.8 的完整指南"}],["meta",{"property":"og:description","content":"backendbackend 一、前言 本文面向需要在 Linux 服务器（以 Ubuntu 为例）上并行安装多版本 Python 的开发者和运维人员。通过源码编译的方式，我们将安全地在腾讯云 CVM 上部署 Python 3.12.8，同时完整保留系统原有 Python 环境。本方案具有以下特点： ✅ 100% 兼容性测试（Ubuntu 20.04/..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://oss.moniter.top/blog/2025-02-19/backend.jpg"}],["meta",{"property":"og:locale","content":"zh-CN"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"在腾讯云 CVM 上安全安装 Python 3.12.8 的完整指南\\",\\"image\\":[\\"https://oss.moniter.top/blog/2025-02-19/backend.jpg\\"],\\"dateModified\\":null,\\"author\\":[]}"]]},"headers":[],"git":{},"autoDesc":true,"filePathRelative":"notes/linux/Systemd/4.多版本python安装.md"}');export{g as comp,A as data};
