import{_ as e,c as t,a,b as h,d as n,w as p,r as k,o as c,e as l}from"./app-BVpc6fz1.js";const d={},r={class:"table-of-contents"};function o(A,s){const i=k("router-link");return c(),t("div",null,[a("nav",r,[a("ul",null,[a("li",null,[n(i,{to:"#简介"},{default:p(()=>s[0]||(s[0]=[l("简介")])),_:1})]),a("li",null,[n(i,{to:"#docker-hub"},{default:p(()=>s[1]||(s[1]=[l("Docker Hub")])),_:1}),a("ul",null,[a("li",null,[n(i,{to:"#注册"},{default:p(()=>s[2]||(s[2]=[l("注册")])),_:1})]),a("li",null,[n(i,{to:"#登录"},{default:p(()=>s[3]||(s[3]=[l("登录")])),_:1})]),a("li",null,[n(i,{to:"#拉取镜像"},{default:p(()=>s[4]||(s[4]=[l("拉取镜像")])),_:1})]),a("li",null,[n(i,{to:"#推送镜像到自己的docker-hub上面"},{default:p(()=>s[5]||(s[5]=[l("推送镜像到自己的docker Hub上面")])),_:1})]),a("li",null,[n(i,{to:"#自动创建"},{default:p(()=>s[6]||(s[6]=[l("自动创建")])),_:1})])])]),a("li",null,[n(i,{to:"#私有仓库"},{default:p(()=>s[7]||(s[7]=[l("私有仓库")])),_:1}),a("ul",null,[a("li",null,[n(i,{to:"#_1-基本私有仓库"},{default:p(()=>s[8]||(s[8]=[l("1. 基本私有仓库")])),_:1})]),a("li",null,[n(i,{to:"#_2-配置安全认证"},{default:p(()=>s[9]||(s[9]=[l("2. 配置安全认证")])),_:1})])])])])]),s[10]||(s[10]=h(`<hr><h2 id="简介" tabindex="-1"><a class="header-anchor" href="#简介"><span>简介</span></a></h2><p>Docker 镜像仓库是用于存储和分发 Docker 镜像的服务。主要概念：</p><ul><li><strong>仓库(Repository)</strong>: 存放镜像的地方</li><li><strong>注册服务器(Registry)</strong>: 管理仓库的服务器</li><li><strong>标签(Tag)</strong>: 标识镜像的版本</li></ul><blockquote><p>例如：对于仓库地址 <code>dl.dockerpool.com/ubuntu</code></p><ul><li><code>dl.dockerpool.com</code> 是注册服务器地址</li><li><code>ubuntu</code> 是仓库名</li></ul></blockquote><h2 id="docker-hub" tabindex="-1"><a class="header-anchor" href="#docker-hub"><span>Docker Hub</span></a></h2><p>Docker Hub 是 Docker 官方维护的公共仓库，提供了超过 15,000 个镜像。它是最常用的镜像来源。</p><h3 id="注册" tabindex="-1"><a class="header-anchor" href="#注册"><span>注册</span></a></h3><p>访问 <a href="https://hub.docker.com" target="_blank" rel="noopener noreferrer">https://hub.docker.com</a> 免费注册账号。</p><h3 id="登录" tabindex="-1"><a class="header-anchor" href="#登录"><span>登录</span></a></h3><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">登录</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">login</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">退出</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">logout</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="拉取镜像" tabindex="-1"><a class="header-anchor" href="#拉取镜像"><span>拉取镜像</span></a></h3><ol><li><p>搜索镜像</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">search</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">centos</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><strong>搜索结果说明：</strong></p><ul><li>NAME: 镜像名称</li><li>DESCRIPTION: 镜像描述</li><li>STARS: 镜像的受欢迎程度</li><li>OFFICIAL: 是否为官方镜像</li><li>AUTOMATED: 是否自动构建</li></ul><p><strong>镜像类型：</strong></p><ul><li>官方镜像：如 <code>centos</code>，由 Docker 官方维护</li><li>用户镜像：如 <code>username/centos</code>，由用户创建维护</li></ul><blockquote><p><strong>提示：</strong> 使用 <code>--filter=stars=N</code> 可以过滤星级</p></blockquote></li><li><p>下载镜像</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">pull</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">centos</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ol><h3 id="推送镜像到自己的docker-hub上面" tabindex="-1"><a class="header-anchor" href="#推送镜像到自己的docker-hub上面"><span>推送镜像到自己的docker Hub上面</span></a></h3><blockquote><p>将镜像推送到自己的docker Hub上面需要进行登录到自己的账户上。 请使用 <code>docker login</code>,退出登录请使用<code>docker logout</code>,之后使用docker push进行上传 用户也可以在登录后通过<code>docker push</code>命令将自己的镜像推送到Docker Hub<br> 下面命令中的<code>username</code>替换为自己的Docker账户用户名</p></blockquote><ol><li><p>登录账号</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">login</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>标记镜像</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">tag</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">centos:7</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">username/centos:7</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>推送镜像</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">push</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">username/centos:7</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ol><h3 id="自动创建" tabindex="-1"><a class="header-anchor" href="#自动创建"><span>自动创建</span></a></h3><p>Docker Hub 支持通过 GitHub 或 BitBucket 自动构建镜像：</p><ol><li>创建并登录 Docker Hub</li><li>关联 GitHub/BitBucket 账号</li><li>配置自动构建</li><li>选择代码仓库和分支</li><li>指定 Dockerfile 位置</li></ol><blockquote><p><strong>优点：</strong> 代码更新时自动构建新镜像，无需手动更新</p></blockquote><h2 id="私有仓库" tabindex="-1"><a class="header-anchor" href="#私有仓库"><span>私有仓库</span></a></h2><h3 id="_1-基本私有仓库" tabindex="-1"><a class="header-anchor" href="#_1-基本私有仓库"><span>1. 基本私有仓库</span></a></h3><h4 id="_1-1-安装运行" tabindex="-1"><a class="header-anchor" href="#_1-1-安装运行"><span>1.1 安装运行</span></a></h4><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">启动私有仓库容器</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">run</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-d</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-p</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">5000:5000</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">--restart=always</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">--name</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">registry</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">registry</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">将仓库数据持久化到主机</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">run</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-d</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-p</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">5000:5000</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">--restart=always</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">--name</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">registry</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-v</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/mnt/registry:/var/lib/registry</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">registry</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_1-2-使用私有仓库" tabindex="-1"><a class="header-anchor" href="#_1-2-使用私有仓库"><span>1.2 使用私有仓库</span></a></h4><ol><li><p>标记下载启动镜像镜像</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">pull</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">registry</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#启动容器</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">run</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-d</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-p</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">5000:5000</span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">--restart</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">always</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">--name=registry</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-v</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/mnt/docker:/var/lib/</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">registry</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">registry</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>推送镜像</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">push</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">localhost:5000/centos:7</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>查看仓库镜像</p><blockquote><p>当想让本网段的其他主机也能把镜像推送到私有仓库，就需要设置仓库地址为内网IP，但由于Docker默认不允许非HTTPS方式 推送镜像。<br> 所以，需要通过Docker的配置选项来取消这个限制。或者配置能够通过HTTPS访问私有仓库。<br> Centos配置HTTP上传到私有仓库</p></blockquote><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">cat</span><span class="space"> </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/etc/docker/daemon.json</span><span class="space"> </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&lt;&lt;</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">EOF</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">{</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">&quot;registry-mirror&quot;:[</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">&quot;https://registry.docker-cn.com&quot;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">],</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">&quot;insecure-registries&quot;:[</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">&quot;192.168.199.100:5000&quot;</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">]</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">}</span></span>
<span class="line"><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">EOF</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">curl</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">http://localhost:5000/v2/_catalog</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h3 id="_2-配置安全认证" tabindex="-1"><a class="header-anchor" href="#_2-配置安全认证"><span>2. 配置安全认证</span></a></h3><h4 id="_2-1-生成证书" tabindex="-1"><a class="header-anchor" href="#_2-1-生成证书"><span>2.1 生成证书</span></a></h4><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">创建证书目录</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">mkdir</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-p</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">certs</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">生成证书</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">req</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-newkey</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">rsa:4096</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-nodes</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-sha256</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-keyout</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">certs/domain.key</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-x509</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-days</span><span class="space"> </span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">365</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-out</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">certs/domain.crt</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="生成证书案例" tabindex="-1"><a class="header-anchor" href="#生成证书案例"><span>生成证书案例</span></a></h5><ul><li><p>当有一个域名，就可以使用<code>openssl</code>自行签发证书。</p></li><li><p><strong>过程</strong></p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">创建CA私钥</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">genrsa</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-out</span><span class="space"> </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">root-ca.key</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span class="space"> </span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">4096</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">利用私钥创建CA根证书请求文件</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">req</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-new</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-key</span><span class="space"> </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">root-ca.key</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span><span class="space"> </span><span class="space"> </span><span class="space"> </span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">-out</span><span class="space"> </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">root-ca.csr</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-sha256</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-subj</span><span class="space"> </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/C=CN/ST=Shanxi/L=Datong/O=Your</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Company</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Name/CN=Your</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Company</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Name</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Docker</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Registry</span><span class="space"> </span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">CA</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">-subj</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">/C</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">表示国家；</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">/ST</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">表示省</span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">/L</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">表示城市</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">/O</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">表示组织名</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">/CN通用名称</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">配置CA根证书，新建root-ca.cnf</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">vim</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">root-ca.cnf</span></span>
<span class="line"><span style="--shiki-light:#999999;--shiki-dark:#666666;">[</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">root-ca</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">]</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">basicConstraints</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">=</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">critical,CA:TRUE,pathlen:1</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">keyUsage</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">=</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">critical,</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">nonRepudiation,</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">cRLSign,</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">keyCertSign</span></span>
<span class="line"><span style="--shiki-light:#B07D48;--shiki-dark:#BD976A;">subjectKeyIdentifier</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">=</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">hash</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">签发根证书</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">x509</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-req</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-days</span><span class="space"> </span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">3650</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-in</span><span class="space"> </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">root-ca.csr</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-signkey</span><span class="space"> </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">root-ca.key</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-sha256</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-out</span><span class="space"> </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">root-ca.crt</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-extfile</span><span class="space"> </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">root-ca.cnf</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-extensions</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">root_ca</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">生成站点SSL私钥</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">genrsa</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-out</span><span class="space"> </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">www.wanglhdocker.com.key</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span class="space"> </span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">4096</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">使用私钥生成证书请求文件</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">req</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-new</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-key</span><span class="space"> </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">www.wanglhdocker.com.key</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-out</span><span class="space"> </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">site.csr</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-sha256</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-subj</span><span class="space"> </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/C=CN/ST=Shanxi/L=Datong/O=Your</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Company</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Name/CN=www.wanglhdocker.com</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">配置证书，新建site.cnf文件</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">cat</span><span class="space"> </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">site.cnf</span><span class="space"> </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&lt;&lt;</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">EOF</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">[server]</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">authorityKeyIdentifier=keyid,issuer</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">basicConstraints</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">=</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">critical,CA:FALSE</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">extendedKeyUsage=serverAuth</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">keyUsage</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">=</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">critical,</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">digitalSignature,</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">keyEncipherment</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">subjectAltName</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">=</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">DNS:docker.domain.com,</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">IP:127.0.0.1</span></span>
<span class="line"><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">subjectKeyIdentifier=hash</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">EOF</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">签署站点SSL证书</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">openssl</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">x509</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-req</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-days</span><span class="space"> </span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">750</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-in</span><span class="space"> </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">site.csr</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-sha256</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-CA</span><span class="space"> </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">root-ca.crt</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-CAkey</span><span class="space"> </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">root-ca.key</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-CAcreateserial</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-out</span><span class="space"> </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">www.wanglhdocker.com.crt</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-extfile</span><span class="space"> </span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">site.cnf</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-extensions</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">server</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">自改</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">hosts，并启动</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">##如此，就有了www.wanglhdocker.com的网站SSL私钥www.wanglhdocker.com.key和SSL证书www.wanglhdocker.</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">com.crt及CA根证书</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">root-ca.crt</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>将生成的三个文件 移动到一个文件，删除其他文件夹</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">curl</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-L</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">https://github.com/docker/compose/releases/download/1.24.0-rc1/docker-compose-</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">\`</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">uname</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">-s</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">\`</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">-</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">\`</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">uname</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-m</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">\`</span><span class="space"> </span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">-o</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/usr/local/bin/docker-compose</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">mv</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/use/local/bin/docker-compose</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/usr/bin/docker-compose</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">chmod</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">+x</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/usr/bin/docker-compose</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h4 id="_2-2-配置认证" tabindex="-1"><a class="header-anchor" href="#_2-2-配置认证"><span>2.2 配置认证</span></a></h4><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">创建认证文件</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">mkdir</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">auth</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">run</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">--rm</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">--entrypoint</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">htpasswd</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">registry</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-Bbn</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">username</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">password</span><span class="space"> </span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">auth/htpasswd</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">启动带认证的仓库</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">run</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-d</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-p</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">5000:5000</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">--restart=always</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">--name</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">registry</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-v</span><span class="space"> </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">\`</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">pwd</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">\`</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">/auth:/auth</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-v</span><span class="space"> </span><span style="--shiki-light:#999999;--shiki-dark:#666666;">\`</span><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">pwd</span><span style="--shiki-light:#999999;--shiki-dark:#666666;">\`</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">/certs:/certs</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-e</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">REGISTRY_AUTH=htpasswd</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-e</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">REGISTRY_AUTH_HTPASSWD_REALM=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Registry</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">Realm</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-e</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">REGISTRY_AUTH_HTPASSWD_PATH=/auth/htpasswd</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-e</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">REGISTRY_HTTP_TLS_CERTIFICATE=/certs/domain.crt</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-e</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">REGISTRY_HTTP_TLS_KEY=/certs/domain.key</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">\\</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">registry</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2-3-客户端配置" tabindex="-1"><a class="header-anchor" href="#_2-3-客户端配置"><span>2.3 客户端配置</span></a></h4><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#</span><span class="space"> </span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">复制证书</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">mkdir</span><span class="space"> </span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">-p</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/etc/docker/certs.d/myregistry:5000</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">cp</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">domain.crt</span><span class="space"> </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">/etc/docker/certs.d/myregistry:5000/ca.crt</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,35))])}const y=e(d,[["render",o],["__file","index.html.vue"]]),u=JSON.parse('{"path":"/linux/7ykbt1pd/","title":"09. 访问仓库","lang":"zh-CN","frontmatter":{"createTime":"2025/02/17 16:59:04","permalink":"/linux/7ykbt1pd/","title":"09. 访问仓库","description":"简介 Docker 镜像仓库是用于存储和分发 Docker 镜像的服务。主要概念： 仓库(Repository): 存放镜像的地方 注册服务器(Registry): 管理仓库的服务器 标签(Tag): 标识镜像的版本 例如：对于仓库地址 dl.dockerpool.com/ubuntu dl.dockerpool.com 是注册服务器地址 ubuntu...","head":[["meta",{"property":"og:url","content":"https://notes.moniter.top/linux/7ykbt1pd/"}],["meta",{"property":"og:site_name","content":"Richie Lin"}],["meta",{"property":"og:title","content":"09. 访问仓库"}],["meta",{"property":"og:description","content":"简介 Docker 镜像仓库是用于存储和分发 Docker 镜像的服务。主要概念： 仓库(Repository): 存放镜像的地方 注册服务器(Registry): 管理仓库的服务器 标签(Tag): 标识镜像的版本 例如：对于仓库地址 dl.dockerpool.com/ubuntu dl.dockerpool.com 是注册服务器地址 ubuntu..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"09. 访问仓库\\",\\"image\\":[\\"\\"],\\"dateModified\\":null,\\"author\\":[]}"]]},"headers":[],"git":{},"autoDesc":true,"filePathRelative":"notes/linux/Kubernetes/Docker系列学习/Docker系列学习-09.访问仓库.md"}');export{y as comp,u as data};
